<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>自定义视频播放器</title>
<link href="css/cv15/cv15.css" type="text/css" rel="stylesheet" />
<script>
window.onload=function (){
	
	var oV    = document.getElementById("v1");
	var oStop = document.getElementById("stop");
	var oPrev = document.getElementById("prev");
	var oPlay = document.getElementById("play");
	var oPause = document.getElementById("pause");
	var oNext = document.getElementById("next");
	var oSpeedBox  = document.querySelector(".speed");
	var oCur  = document.querySelector(".speed_this");
	var oBtn  = oCur.querySelector(".button");
	
	var oBuff = document.querySelector(".speed_buffer");
	var curTime = document.getElementById("curTime");//curTime 00:00 
	var totalTime = document.getElementById("totalTime");//totalTime
	var oVolume = document.querySelector(".volume_this");//volume_this 声音
	var oBtnVol  = oVolume.querySelector(".button");
	
	var maxW = oSpeedBox.offsetWidth - oBtn.offsetWidth;
	
	
	
	
	
	//声音
	//进度拖拽
	oBtnVol.onmousedown = function(ev){
		var disX = ev.clientX - oBtnVol.offsetLeft;
		
		document.onmousemove = function(ev){
			var maxW = oVolume.parentNode.offsetWidth - oBtnVol.offsetWidth;
			var l = ev.clientX - disX;
			if(l < 0){
				l = 0;
			} else if(l > maxW){
			    l = maxW;
			}

			var scale = l/maxW;
			oVolume.style.width = scale*100 + "%";
			
			//[0,1]
			oV.volume = scale;
				
		};
		
		document.onmouseup = function(){
			document.onmousemove = null;
			document.onmouseup = null;
		};
		return false;	
	};
	
	oV.onended = function(){
		alert("视频播放完了！ 谢谢观赏！");	
	};
	
	
	setTimeout(function(){
		//缓存 progress
		oV.onprogress = function(){
			
			//缓冲进度/总时长
			//start
			var scale = this.buffered.end(0)/this.duration;
			oBuff.style.width = scale*100 + "%";
			
		};
	},1000);
	
	
	
	//进度拖拽
	oBtn.onmousedown = function(ev){
		oV.pause();
		var disX = ev.clientX - oBtn.offsetLeft;
		
		document.onmousemove = function(ev){
			
			
			var l = ev.clientX - disX;
			if(l < 0){
				l = 0;
			} else if(l > maxW){
			    l = maxW;
			}
			
			//oBtn.style.left = l + "px";
			var scale = l/maxW;
			oCur.style.width = scale*100 + "%";
				
		};
		
		document.onmouseup = function(){
			document.onmousemove = null;
			document.onmouseup = null;
			
			//回复播放
			oV.currentTime = oBtn.offsetLeft/maxW*oV.duration;
			oV.play();
		};
		return false;	
	};
	
	
	//播放进度
	oV.ontimeupdate = function(){
		
		
		var scale = this.currentTime/this.duration;
		oCur.style.width = scale*100 + "%";
		
		curTime.innerHTML = formatTime(this.currentTime);
		totalTime.innerHTML = formatTime(this.duration); 
			
	};
	
	
	
	
	
	
	//播放
	oPlay.onclick = function(){
		oV.play();
		this.style.display = "none";	
		oPause.style.display = "block";	
	};
	
	//暂停
	oPause.onclick = function(){
		oV.pause();
		this.style.display = "none";	
		oPlay.style.display = "block";	
	};
	//停止
	oStop.onclick = function(){
		oV.pause();
		oV.currentTime = 0;
		oPlay.style.display = "block";	
		oPause.style.display = "none";	
		
	};
	
	
};

function addZero(n){
	return n < 10 ? "0" + n : "" + n;	
}

function formatTime(s){
	//m  s
	var m = parseInt(s/60);
	var s = parseInt(s%60);
	return addZero(m) + ":" + addZero(s);
}
	 
	 
</script>
</head>

<body>
<div class="videoBox">
	<div class="video_list" style="width:0%;">
    	<dl class="list">
        	<dt><span>播放列表</span></dt>
        	<dd><a href="#">影片剪辑</a><span>20分15秒</span></dd>
        </dl>
        <a href="javascript:;" class="listBtnContraction">&nbsp;</a>
        <a href="javascript:;" class="listBtnOpen">&nbsp;</a>
    </div>
    <div class="video_play" style="width:100%;">
    	<div class="video">
			<div id="video_open_div" style="display:none;">
				<img src="img/cv15/loading.png" class="loading" alt="" style="display:none;" />
				<input type="button" class="open" value="" />
				<div class="openLink">
					<input type="text" value="" class="input" />
					<input type="button" value="" class="openBtn" />
				</div>
			</div>
			<div id="video_div" style="display:block;">
                <video id="v1" width="100%" height="100%" src="http://images.sohu.com/ytv/SH/Coke/64036020120714021103.mp4"></video>
			</div>
        </div>
        <div class="videoBar">
        	<!--播放 暂停 等操作部分-->
            <div class="play">
                <img id="stop" src="img/cv15/stop.png" alt="www.zhinengshe.com" />
				<img id="prev" src="img/cv15/prev.jpg" alt="www.zhinengshe.com" />
				<img id="play" src="img/cv15/play.jpg" alt="www.zhinengshe.com" />
				<img id="pause" src="img/cv15/pause.jpg" alt="www.zhinengshe.com" style="display:none;" />
				<img id="next" src="img/cv15/next.jpg" alt="www.zhinengshe.com" />
            </div>
            <!--声音-->
            <div class="full">
            	<div class="timer">
                	<span class="timeThis" id="curTime">00:00</span>/<span id="totalTime">00:00</span>
                </div>
                
                <div class="volume">
                    <div class="volume_this" style="width:100%;"><div class="button"></div></div>
                </div>
                <img src="img/cv15/horn.png" style="float:right; margin-top:13px; margin-right:10px;" />
            </div>
        </div>
        <!--进度条-->
        <div class="speed">
            <div class="speed_buffer" style="width:0%;"></div>
            <div class="speed_this" style="width:0%;"><div class="button"></div></div>
        </div>
    </div>
    
</div>
</body>
</html>
